<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux/x86 (vers 11 February 2007), see www.w3.org" />
  <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />

  <title>The Phantasmal MUDlib for DGD: Arrays
</title>
  <link href="../../css/default.css" type="text/css" rel="stylesheet" />
</head>

<body>
  <div class="header_pane">
    <p>Phantasmal MUD Lib for DGD</p>

  </div>

  <div class="banner_pane">
    <table class="banner">
  <tr>
    <td class="banner" align="center">
      <a href="http://validator.w3.org/check/referer"><img src=
      "http://www.w3.org/Icons/valid-xhtml10" alt=
      "Valid XHTML 1.0 Strict!" style=
      "border: 0; width: 88px; height: 31px;"/></a> <a href=
      "http://jigsaw.w3.org/css-validator/check/referer"><img src=
      "http://jigsaw.w3.org/css-validator/images/vcss" alt=
      "Valid CSS!" style=
      "border: 0; width: 88px; height: 31px;"></a> <a href=
      "http://sourceforge.net"/></a><img src=
      "http://sourceforge.net/sflogo.php?group_id=48659&amp;type=2"
      style="border: 0; width: 125px; height: 37px;" alt=
      "SourceForge.net Logo"/>
    </td>
  </tr>
</table>

  </div>

  <table>
    <tr>
      <td valign="top" class="index_pane">
        <ul>
<li><a href="../../index.html">Phantasmal Site</a></li>
<ul>
<li><a href="../../History.html">History</a></li>
<li><a href="../../Installing.html">Installing Baseline Phantasmal</a></li>
<li><a href="../../Comparison.html">Comparison to Other Libs</a></li>
<li><a href="../../Credits.html">Credits</a></li>
<li><a href="../../Current.html">Current Features</a></li>
<li><a href="../../WhatIsPhantasmal.html">About</a></li>
<li><a href="../../API/index.html">Phantasmal API</a></li>
<li><a href="../../Archive/index.html">Archive</a></li>
<li><a href="../index.html">DGD</a></li>
<ul>
<li><a href="../Manual/index.html">DGD Reference Manual</a></li>
<li><a href="../CSharp_vs_DGD.html">CSharp vs DGD</a></li>
<li><a href="../Contribute.html">Contributing to DGD</a></li>
<li><a href="../DGD_Terms.html">DGD Glossary</a></li>
<li><a href="../Java_vs_DGD.html">Java vs DGD</a></li>
<li><a href="../MUDs_using_DGD.html">DGD MUDs</a></li>
<li><a href="../Misc_DGD.html">Miscellaneous DGD</a></li>
<li><a href="../MudOS_vs_DGD.html">MudOS vs DGD</a></li>
<li><a href="../SlushBucket.html">Slush Bucket</a></li>
<li><a href="../Why_DGD.html">Why Use DGD?</a></li>
<li><a href="index.html">DGD Reference Manual (legacy)</a></li>
<ul>
<li><a href="ControlFlow.html">Control Flow</a></li>
<li><a href="ControlFlow_ForWhile.html">For and While Loops</a></li>
<li><a href="Introduction.html">Introduction</a></li>
<li><a href="Misc.html">A Miscellany This section consists of various</a></li>
<li><a href="Misc_DGDVersions.html">DGD Version Numbers</a></li>
<li><a href="Misc_EditorQuick.html">DGD Editor Quick Reference</a></li>
<li><a href="Misc_LPCHistory.html">A Brief History of LPC</a></li>
<li><a href="Setup.html">Setting Up DGD</a></li>
<li><a href="Setup_Installing.html">Installing DGD</a></li>
<li><a href="Setup_KernelOverview.html">An Overview of the Kernel Library</a></li>
<li><a href="Setup_RunKernel.html">Running the Kernel Library</a></li>
<li><a href="Tutorial.html">A Quick LPC Tutorial</a></li>
<li><a href="Tutorial_Arguments.html">Arguments and Call-By-Value</a></li>
<li>Arrays</li>
<li><a href="Tutorial_CodeInFiles.html">Making and Using LPC Files</a></li>
<li><a href="Tutorial_Functions.html">Functions</a></li>
<li><a href="Tutorial_GettingStarted.html">Getting Started</a></li>
<li><a href="Tutorial_Loops.html">Looping and Iteration</a></li>
<li><a href="Tutorial_Mappings.html">Mappings</a></li>
<li><a href="Tutorial_Objects.html">Objects</a></li>
<li><a href="Tutorial_StringHandling.html">Simple String Manipulation</a></li>
<li><a href="Tutorial_UserOutput.html">Sending Output to the User</a></li>
<li><a href="Tutorial_VariableScope.html">External Variables and Scope</a></li>
<li><a href="Tutorial_VarsAndExprs.html">Variables and Arithmetic Expressions</a></li>
</ul>
<li><a href="../Config/index.html">Getting DGD</a></li>
<li><a href="../GameDesign/index.html">Game Design Issues</a></li>
<li><a href="../Kernel/index.html">The Kernel Library</a></li>
<li><a href="../LPC/index.html">Untitled document (LPC/index.base.html)</a></li>
<li><a href="../LibWriting/index.html">Writing a Library</a></li>
<li><a href="../Operation/index.html">What Does It Do?</a></li>
<li><a href="../Programming/index.html">DGD LPC Reference</a></li>
<li><a href="../Running/index.html">Running a MUD</a></li>
<li><a href="../Skotos/index.html">Skotos</a></li>
</ul>
<li><a href="../../Design/index.html">Design</a></li>
<li><a href="../../Development/index.html">Development</a></li>
<li><a href="../../Innsmouth/index.html">Innsmouth MUD</a></li>
<li><a href="../../Operation/index.html">Phantasmal Operation</a></li>
<li><a href="../../Setup/index.html">Setup</a></li>
<li><a href="../../Test/index.html">Test module index</a></li>
<li><a href="../../Tutorial/index.html">Phantasmal Tutorials</a></li>
</ul>
</ul>

      </td>
      <td valign="top" class="content_pane">
        <p><a href="index.html">Phantasmal Site</a> > <a href="index.html">DGD</a> > <a href="index.html">DGD Reference Manual (legacy)</a> > Arrays</p>



<h2> 3.7 Arrays </h2>


<p>An <dfn>array</dfn> is a list of values, either all of the same
type or of multiple types. An array makes it easy to reference
values by their number &mdash; for instance, it's easy to say "give
me the fourth value in the array". However, an array is slow when
you add values or remove them.</p>

<p>Let's write a function to count digits in a string. Go ahead and
change <tt>myobj.c</tt> (or make a new file) to the following:</p>
<pre>
mixed count_digits(string str) {
  int   *num_count;
  int    ctr;
  object user;

  num_count = allocate_int(10);

  for(ctr = 0; ctr &lt; strlen(str); ctr++) {
    if((str[ctr] &lt;= '9') &amp;&amp;
       (str[ctr] &gt;= '0')) {
      num_count[str[ctr] - '0']++;
    }
  }

  user = this_user();
  user-&gt;message("Count: [");
  for(ctr = 0; ctr &lt; 10; ctr++) {
    user-&gt;message(num_count[ctr] + " ");
  }
  user-&gt;message("]\n");
}
</pre>

<p>To call this file, first compile it. So you'll type <kbd>compile
/usr/admin/myobj.c</kbd>. If you're not using <tt>myobj.c</tt> as
the filename, substitute the one you're using. You should get a
result like <samp>$34 = &lt;/usr/admin/myobj&gt;</samp>. Now, using
the history variable you get back (we'll pretend it's $34 here),
type <kbd>$34-&gt;count_digits("0123456789")</kbd>, or the
equivalent with your own history variable number. You should see a
result like the following:</p>
<pre>
Count: [1 1 1 1 1 1 1 1 1 1 ]
$36 = nil
</pre>

<p>Since the function doesn't explicitly return anything, the
history variable result is <var>nil</var>. But since the function
calls <code>user-&gt;message</code> to send output to the user
(that's you!), the list of number counts is printed out. Try
calling the function a few more times with arguments different from
"0123456789". It will count the number of occurrences of each digit
in your input.</p>

<p>If you look at the line in the code starting with <code>mixed
count_digits</code>, you'll notice that it's different from the
code in the <a href="Tutorial_CodeInFiles">last section</a>. It
uses a different <dfn>function name</dfn>, <var>count_digits</var>
instead of <var>exec</var>. That's why you typed "count_digits"
when calling the function. You'll also notice that instead of
having <code>object user, mixed argv...</code> in parentheses, it
has <code>string str</code>. That section tells what the function
needs to do its thing. For the "return 7" function, you called it
with <code>this_user()</code>, a user object, in parentheses. For
<var>count_digits</var>, you gave a string which it then counted
numbers in.</p>

<p>There are two new types of variable declaration in the code to
count_digits. There is a variable type called <var>object</var>,
like <var>mixed</var> or <var>int</var>. A variable of type
<var>object</var> will hold a compiled DGD object, such as a
connection object, or the object that <tt>myobj.c</tt> compiles
into. In <var>count_digits</var>, it holds a user object like the
one you passed to the function in the last section.</p>

<p>You'll notice that the variable declaration for
<var>num_count</var> starts with <var>int</var>, but that there's
an asterisk in front of the variable name. The asterisk means that
<var>num_count</var> isn't an integer, but rather an
<dfn>array</dfn> of integers.</p>

<p>Defining <var>num_count</var> doesn't give it a value. Arrays,
like strings, are assigned <var>nil</var> by default, and have to
be initialized to something. One way to assign reasonable values to
an array of integers is the allocate_int function, which returns an
array of zeroes. The array is as long as the number in parentheses
is big. For the example above, that means it returns an array of
ten zeroes.</p>

<p>There are a couple of other new things in the code above. We'll
tackle them one at a time. The first is <code>++</code>, called the
<dfn>increment</dfn> operator. It adds one to whatever variable you
use it on. So if <var>a</var> was a variable, then <code>a++</code>
means "add one to <var>a</var>".</p>

<p>Another is the zero in single quotes. Remember that LPC
characters are represented as ASCII-encoded integers. A character
in single quotes will evaluate the that character's integer. Try
typing <kbd>code 'A'</kbd> and you should get a result of 65, just
like in the <a href="Tutorial_StringHandling">section on handling
strings</a>. The 'if' statement checks to make sure that the
character is a number between 0 and 9. That way letter, spaces and
punctuation will be ignored.</p>

<p>The final new feature of the code is the square brackets, called
the <dfn>array dereference</dfn> operator. The idea is that for an
array, like a string, you can take a single element from it. So if
an array called <var>arr</var> contains a zero followed by four
nines, then the value of <code>arr[0]</code> is zero, and the value
of <code>arr[1]</code>, <code>arr[2]</code> and <code>arr[3]</code>
would each be nine. If you tried to check <code>arr[4]</code>,
you'd get an error because there are only four elements and you
tried to ask about the fifth one.</p>

<p>In <code>num_count[str[ctr] - '0']++;</code>, the square
brackets are used twice, one inside the other. The first is to
dereference a character of the string, just like before. Then
<code>'0'</code> is subtracted from that character. The numbers 0
through 9, when ASCII encoded, become 48 through 57. Since the
numbers are in order, starting with zero, you can subtract ASCII
zero (which equals the number 48) from an ASCII digit such as the
ones you typed in, and get a number 0 through 9 for which digit it
was. That's why we subtract the character zero from that character
of the string.</p>

<p>The second dereference, the one outside, is an array
dereference, not a string dereference, but they work the same way
if you think of a string as being like an array of ASCII-encoded
characters. Since subtracting the character <code>'0'</code> leaves
a number between 0 and 9, we can then use that character as the
<dfn>offset</dfn> within the array. Since the array has ten
elements, they're numbered 0 through 9.</p>

<p>To write an array value in LPC, you surround the entries with
parentheses and curly braces and separate the entries with commas.
So the array mentioned above would be written <code>({ 0, 9, 9, 9,
9 })</code> in LPC. Instead of the allocate_int call, you could
have written <code>num_count = ({ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
});</code> The curly braces have to be <em>inside</em> the
parentheses, they can't be outside them.</p>

<p>Arrays can also be added to each other like strings. Adding them
will make a new array which is all the elements of the first array
followed by all the elements of the second array. So <kbd>code ({
1, 2, 3 }) + ({ 7, 8, 9 })</kbd> will print a result like <samp>$40
= ({ 1, 2, 3, 7, 8, 9 })</samp>.</p>


<table style="width: 100%; border: 1px">
  <tr>

    <td><a href="Tutorial_CodeInFiles.html"> &lt;&mdash; Prev<br /> Making and Using LPC Files </a></td>

    <td align="center"><a href="Tutorial.html"> Up<br /> A Quick LPC Tutorial </a></td>

    <td align="right"><a href="Tutorial_Mappings.html"> Next &mdash;&gt; <br />Mappings </a></td>
  </tr>
</table>

      </td>
    </tr>
  </table>

  <div class="footer_pane">
    <p>Copyright (C) 2010 Raymond Jennings</p>
<p>This website is released to the public under the terms of the
GNU Free Documentation License, Version 1.3 or later</p>

  </div>
</body>
</html>
